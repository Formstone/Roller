/* 
 * Roller v3.0.0 - 2014-01-06 
 * A jQuery plugin for simple content carousels. Part of the Formstone Library. 
 * http://formstone.it/roller/ 
 * 
 * Copyright 2014 Ben Plum; MIT Licensed 
 */ 

!function(a){"use strict";function b(b){b=a.extend({},q,b);for(var d=a(this),e=0,f=d.length;f>e;e++)c(d.eq(e),b);return d}function c(b,c){if(!b.data("roller")){c=a.extend({},c,b.data("roller-options"));var e="";c.controls&&(e+='<div class="roller-controls">',e+='<span class="roller-control previous">Previous</span>',e+='<span class="roller-control next">Next</span>',e+="</div>"),c.pagination&&(e+='<div class="roller-pagination">',e+="</div>"),b.wrapInner('<div class="roller-viewport"><div class="roller-canister"></div></div>').append(e);var f=a.extend({},{$roller:b,$viewport:b.find(".roller-viewport").eq(0),$canister:b.find(".roller-canister").eq(0),$captions:b.find(".roller-captions").eq(0),$controls:b.find(".roller-controls").eq(0),$pagination:b.find(".roller-pagination").eq(0),index:0,deltaX:null,deltaY:null,leftPosition:0,xStart:0,yStart:0,enabled:!1,touchstart:0,touchEnd:0},c);if(f.$items=f.$canister.children(".roller-item"),f.$captionItems=f.$captions.find(".roller-caption"),f.$controlItems=f.$controls.find(".roller-control"),f.$paginationItems=f.$pagination.find(".roller-page"),f.$images=f.$canister.find("img"),f.totalImages=f.$images.length,f.single&&f.$roller.addClass("roller-single"),b.data("roller",f).addClass("initialized"),r.enable.apply(f.$roller),f.auto&&(f.autoTimer=o(f.autoTimer,f.autoTime,function(){h(f)},!0)),f.totalImages>0){f.loadedImages=0;for(var g=0;g<f.totalImages;g++){var i=f.$images.eq(g);i.one("load.roller",f,d),(i[0].complete||i[0].height)&&i.trigger("load.roller")}}}}function d(a){var b=a.data;b.loadedImages++,b.loadedImages===b.totalImages&&r.resize.apply(b.$roller)}function e(a){a.stopPropagation();var b=a.data;p(b.autoTimer),b.touchStart=(new Date).getTime(),b.$canister.css(n("transition","none"));var c="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;b.xStart=c?c.pageX:a.clientX,b.yStart=c?c.pageY:a.clientY,b.$canister.on("touchmove.roller",b,f).one("touchend.roller touchcancel.roller",b,g)}function f(a){a.stopPropagation();var b=a.data,c="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;b.deltaX=b.xStart-(c?c.pageX:a.clientX),b.deltaY=b.yStart-(c?c.pageY:a.clientY),(b.deltaX<-10||b.deltaX>10)&&a.preventDefault(),b.touchLeft=b.leftPosition-b.deltaX,b.touchLeft>0&&(b.touchLeft=0),b.touchLeft<b.maxMove&&(b.touchLeft=b.maxMove),b.useMargin?b.$canister.css({marginLeft:b.touchLeft}):b.$canister.css(n("transform","translate3d("+b.touchLeft+"px, 0, 0)"))}function g(a){var b=a.data;b.touchEnd=(new Date).getTime(),b.leftPosition=b.touchLeft,b.$canister.css(n("transition","")),b.$canister.off("touchmove.roller touchend.roller touchcancel.roller");var c=m(b);b.touchPaged&&!b.swipe?k(b,c):(b.index=c,l(b)),b.deltaX=null,b.touchStart=0,b.touchEnd=0}function h(a){var b=a.index+1;b>a.pageCount&&(b=0),k(a,b)}function i(b){b.preventDefault(),b.stopPropagation();var c=b.data,d=c.index+(a(b.currentTarget).hasClass("next")?1:-1);p(c.autoTimer),k(c,d)}function j(b){b.preventDefault(),b.stopPropagation();var c=b.data,d=c.$paginationItems.index(a(b.currentTarget));p(c.autoTimer),k(c,d)}function k(a,b){if(0>b&&(b=0),b>a.pageCount&&(b=a.pageCount),a.single)a.$items.removeClass("active").eq(b).addClass("active");else{if(a.paged){var c=a.$items.eq(b).position();c&&(a.leftPosition=-c.left)}else a.leftPosition=-(b*a.pageMove);a.leftPosition<a.maxMove&&(a.leftPosition=a.maxMove),a.useMargin?a.$canister.css({marginLeft:a.leftPosition}):a.$canister.css(n("transform","translate3d("+a.leftPosition+"px, 0, 0)"))}a.index=b,l(a),a.$roller.trigger("update.roller")}function l(a){if(a.$captionItems.filter(".active").removeClass("active"),a.$captionItems.eq(a.index).addClass("active"),a.$paginationItems.filter(".active").removeClass("active"),a.$paginationItems.eq(a.index).addClass("active"),a.$items.removeClass("visible"),!a.single&&"Infinity"!==a.perPage)for(var b=0;b<a.perPage;b++)a.leftPosition===a.maxMove?a.$items.eq(a.count-1-b).addClass("visible"):a.$items.eq(a.perPage*a.index+b).addClass("visible");a.pageCount<=0?a.$controlItems.removeClass("enabled"):(a.$controlItems.addClass("enabled"),a.index<=0?a.$controlItems.filter(".previous").removeClass("enabled"):(a.index>=a.pageCount||a.leftPosition===a.maxMove)&&a.$controlItems.filter(".next").removeClass("enabled"))}function m(b){if(b.single)return b.index;if((b.deltaX>20||b.deltaX<-20)&&b.touchStart&&b.touchEnd&&b.touchEnd-b.touchStart<200)return b.index+(b.deltaX>0?1:-1);if(b.paged){var c=1/0;if(b.leftPosition===b.maxMove)return b.$items.length-1;var d=0;return b.$items.each(function(e){var f=a(this).position(),g=f.left+b.leftPosition;0>g&&(g=-g),c>g&&(c=g,d=e)}),d}return Math.round(-b.leftPosition/b.viewportWidth)}function n(a,b){var c={};return c["-webkit-"+a]=b,c["-moz-"+a]=b,c["-ms-"+a]=b,c["-o-"+a]=b,c[a]=b,c}function o(a,b,c,d){return p(a,d),d===!0?setInterval(c,b):setTimeout(c,b)}function p(a){null!==a&&(clearInterval(a),a=null)}var q={auto:!1,autoTime:8e3,controls:!0,customClass:"",duration:500,maxWidth:"Infinity",minWidth:"0",paged:!1,pagination:!0,single:!1,touchPaged:!0,useMargin:!1},r={defaults:function(b){return q=a.extend(q,b||{}),a(this)},destroy:function(){return a(this)},disable:function(){return a(this).each(function(){var b=a(this).data("roller");"undefined"!=typeof b&&(b.enabled&&(p(b.autoTimer),b.$roller.removeClass("roller roller-initialized").off("touchstart.roller click.roller"),b.$canister.css({width:""}).off("touchstart.roller"),b.$pagination.html(""),b.useMargin?b.$canister.css({marginLeft:""}):b.$canister.css(n("transform","translate3d(0px, 0, 0)")),b.index=0),b.enabled=!1)})},enable:function(){return a(this).each(function(){var b=a(this).data("roller");"undefined"!=typeof b&&(b.enabled||(b.$roller.data("roller",b).addClass("roller").on("touchstart.roller click.roller",".roller-control",b,i).on("touchstart.roller click.roller",".roller-page",b,j),r.resize.apply(b.$roller),b.$canister.on("touchstart.roller",b,e)),b.enabled=!0)})},jump:function(b){return a(this).each(function(){var c=a(this).data("roller");"undefined"!=typeof c&&(p(c.autoTimer),k(c,b-1))})},resize:function(){return a(this).each(function(){var b=a(this).data("roller");if("undefined"!=typeof b){if(b.count=b.$items.length,b.viewportWidth=b.$viewport.length>0?b.$viewport.outerWidth(!1):b.$roller.outerWidth(!1),b.single)b.perPage=1,b.pageCount=b.count-1;else if(b.paged){b.maxWidth=0;for(var c=0;c<b.count;c++)b.maxWidth+=b.$items.eq(c).outerWidth(!0);b.perPage=1,b.pageCount=b.maxWidth>b.viewportWidth?b.count-1:0}else b.itemMargin=parseInt(b.$items.eq(0).css("margin-left"),10)+parseInt(b.$items.eq(0).css("margin-right"),10),b.itemWidth=b.$items.eq(0).outerWidth(!1)+b.itemMargin,b.perPage=Math.floor(b.viewportWidth/b.itemWidth),b.perPage<1&&(b.perPage=1),b.pageCount=Math.ceil(b.count/b.perPage)-1,b.pageMove=b.itemWidth*b.perPage,b.maxWidth=b.itemWidth*b.count;if(b.maxMove=-b.maxWidth+b.viewportWidth+b.itemMargin,b.maxMove>0&&(b.maxMove=0),"Infinity"!==b.pageCount){for(var d="",e=0;e<=b.pageCount;e++)d+='<span class="roller-page">'+(e+1)+"</span>";b.$pagination.html(d)}b.pageCount<1?(b.$controls.removeClass("visible"),b.$pagination.removeClass("visible")):(b.$controls.addClass("visible"),b.$pagination.addClass("visible")),b.$paginationItems=b.$roller.find(".roller-page"),b.$canister.css({width:b.maxWidth}),k(b,m(b))}})},reset:function(){return a(this).each(function(){var b=a(this).data("roller");"undefined"!=typeof b&&(b.$items=b.$roller.find(".roller-item"),r.resize.apply(b.$roller))})},respond:function(){return a(this).each(function(){var b=a(this).data("roller"),c=0;"undefined"!=typeof b&&(c>b.minWidth?(r.enable.apply(b.$roller),r.resize.apply(b.$roller)):r.disable.apply(b.$roller))})}};a.fn.roller=function(a){return r[a]?r[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:b.apply(this,arguments)}}(jQuery,window);